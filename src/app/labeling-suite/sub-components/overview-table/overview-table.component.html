<ng-template [ngIf]="dataToDisplay != null">
    <ng-template [ngIf]="dataToDisplay.length > 0" [ngIfElse]="nothingToShow">
        <div class="flex flex-col p-4">
            <div class="overflow-x-auto">
                <div class="inline-block min-w-full align-middle">
                    <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
                        <table class="min-w-full border divide-y divide-gray-300">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col"
                                        class="py-2 pl-4 pr-3 text-left text-xs font-medium uppercase tracking-wide text-gray-500 sm:pl-6"
                                        hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.typeCollection}}">
                                        Type</th>
                                    <th scope="col"
                                        class="px-3 py-2 text-left text-xs font-medium uppercase tracking-wide text-gray-500"
                                        hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.taskCollection}}">
                                        Task</th>
                                    <th scope="col"
                                        class="px-3 py-2 text-left text-xs font-medium uppercase tracking-wide text-gray-500"
                                        hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.createdByCollection}}">
                                        Created by</th>
                                    <th scope="col"
                                        class="px-3 py-2 text-left text-xs font-medium uppercase tracking-wide text-gray-500"
                                        hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.labelCollection}}">
                                        Label</th>
                                    <th scope="col" hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.valueCollection}}">
                                    </th>
                                    <th scope="col" hover-group-class="{{headerHover.class}}"
                                        hover-group="{{headerHover.valueCollection}}">
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200 bg-white">
                                <tr *ngFor="let ovItem of dataToDisplay; let i = index"
                                    [ngClass]="i%2 ==0 ? 'bg-white':'bg-gray-50'">
                                    <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium text-gray-500 sm:pl-6"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.type}}">
                                        {{ovItem.sourceType}}</td>
                                    <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.task}}">
                                        {{ovItem.taskName}}</td>
                                    <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.createdBy}}">
                                        {{ovItem.createdBy}}
                                    </td>
                                    <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.label}}">

                                        <span
                                            class="inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium border border-0 cursor-default relative"
                                            [ngClass]="[ovItem.label.backgroundColor,ovItem.label.textColor,ovItem.label.borderColor]">{{ovItem.label.name}}
                                            <div class="label-overlay-base"
                                                hover-group-class="{{ovItem.hoverGroups.labelClass}}"
                                                hover-group="{{ovItem.hoverGroups.label}}"></div>
                                        </span>
                                        <span class="ml-2" *ngIf="ovItem.label.value">{{ovItem.label.value}}</span>
                                    </td>
                                    <td class="w-icon"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.rlaId}}">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                            stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                                        </svg>
                                    </td>
                                    <td class="w-icon"
                                        hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                                        hover-group="{{ovItem.hoverGroups.rlaId}}">
                                        <div *ngIf="ovItem.canBeDeleted" class="h-full flex items-center">
                                            <label (click)="lsm.recordManager.deleteLabelFromRecord(ovItem.rla.id)"
                                                class="modal-button btn btn-sm btn-ghost px-0">

                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                    class="inline-block w-6 h-6 stroke-current text-red-700" fill="none"
                                                    viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                                </svg>
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div>
                <p class="text-gray-500 text-sm font-normal">You can hover over the table entries to highlight
                    everything <span class="underline cursor-pointer"
                        (click)="lsm.modalManager.modals.overviewTableInfo.open=true">related</span> to the column</p>
            </div>
        </div>
    </ng-template>

    <ng-template #nothingToShow>
        <ng-template [ngIf]="!htmlSettings.showHeuristics && dataHasHeuristics">
            <p class="text-gray-500 p-5">Heuristics display is currently disabled</p>
        </ng-template>
    </ng-template>
</ng-template>


<kern-modal [isOpen]="lsm.modalManager.modals.overviewTableInfo.open" closeButton="X"
    [modalBoxStyle]="{'width':'43rem'}" (optionClicked)="lsm.modalManager.modals.overviewTableInfo.open = false;">
    <ng-template [ngIf]="dataToDisplay">
        <div *ngIf="dataToDisplay[0] as ovItem" class="flex flex-col items-center">
            <div class="flex flex-row gap-x-2 items-center">
                <h1 class="text-lg text-gray-900 text-center font-bold">Info</h1>
            </div>
            <div class="text-gray-500 my-2 text-center mb-2">
                Every label stores a lot of data.<br><br>This can be the label type, the corresponding task, creation
                user or heuristic as well as the label itself.
                Now to get a better overview over every label placed on a record we group the labels by these different
                criteria.<br><br>This means
                there is a group for e.g. type <span class="underline"
                    hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                    hover-group="{{ovItem.hoverGroups.type}}">{{ovItem.sourceType}}</span>. If you hover the element
                everything with the same
                type will be highlighted.
                <br>If you hover over a task (e.g. <span class="underline"
                    hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                    hover-group="{{ovItem.hoverGroups.task}}">{{ovItem.taskName}}</span>) everything with the same task
                will be highlighted. The same goes for the other groups.<br>Note that the magnifying glass highlights
                only the specific label entry.<br><br>
                Feel free to try it out in the table below and focus on the background.
            </div>
            <table class="min-w-full border divide-y divide-gray-300">
                <tbody class="divide-y divide-gray-200 bg-white">
                    <tr class="bg-white">
                        <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium text-gray-500 sm:pl-6"
                            hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                            hover-group="{{ovItem.hoverGroups.type}}">
                            {{ovItem.sourceType}}</td>
                        <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                            hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                            hover-group="{{ovItem.hoverGroups.task}}">
                            {{ovItem.taskName}}</td>
                        <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                            hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                            hover-group="{{ovItem.hoverGroups.createdBy}}">
                            {{ovItem.createdBy}}
                        </td>
                        <td class="whitespace-nowrap px-3 py-2 text-sm text-gray-500"
                            hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                            hover-group="{{ovItem.hoverGroups.label}}">

                            <span
                                class="inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium border border-0 cursor-default relative"
                                [ngClass]="[ovItem.label.backgroundColor,ovItem.label.textColor,ovItem.label.borderColor]">{{ovItem.label.name}}
                                <div class="label-overlay-base" hover-group-class="{{ovItem.hoverGroups.labelClass}}"
                                    hover-group="{{ovItem.hoverGroups.label}}"></div>
                            </span>
                            <span class="ml-2" *ngIf="ovItem.label.value">{{ovItem.label.value}}</span>
                        </td>
                        <td class="w-icon"
                            hover-group-class="{{lsm.settingManager.settings.main.hoverGroupBackgroundColorClass}}"
                            hover-group="{{ovItem.hoverGroups.rlaId}}">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                            </svg>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </ng-template>
</kern-modal>